# Parquet å®è·µç»ƒä¹ é¡¹ç›®

ä¸“ä¸º Parquet æ–‡ä»¶æ ¼å¼å­¦ä¹ è®¾è®¡çš„å®è·µé¡¹ç›®ï¼Œé€šè¿‡æ¸è¿›å¼ç»ƒä¹ å¸®åŠ©æŒæ¡åˆ—å¼å­˜å‚¨çš„æ ¸å¿ƒç‰¹æ€§å’Œæœ€ä½³å®è·µã€‚

## 1. é¡¹ç›®ç‰¹æ€§

- **æ¸è¿›å¼å­¦ä¹ **: ä»åŸºç¡€æ“ä½œåˆ°é«˜çº§ç‰¹æ€§çš„å®Œæ•´å­¦ä¹ è·¯å¾„
- **æ€§èƒ½å¯¹æ¯”**: ç›´è§‚çš„æ€§èƒ½æµ‹è¯•å’Œå¯è§†åŒ–åˆ†æ
- **å®ç”¨å·¥å…·**: å®Œæ•´çš„æ•°æ®ç”Ÿæˆã€åˆ†æå’Œæµ‹è¯•å·¥å…·é›†
- **å®é™…åº”ç”¨**: è´´è¿‘çœŸå®åœºæ™¯çš„ç»ƒä¹ æ¡ˆä¾‹

## 2. ç¯å¢ƒè¦æ±‚

- Python 3.8+
- è‡³å°‘ 2GB å¯ç”¨å†…å­˜
- 500MB å¯ç”¨ç£ç›˜ç©ºé—´

---

## 3. å¿«é€Ÿå¼€å§‹

### 3.1 ç¯å¢ƒå‡†å¤‡

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate  # Linux/macOS
# æˆ– venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 3.2 éªŒè¯å®‰è£…

```bash
python -c "import pandas, pyarrow; print('å®‰è£…æˆåŠŸï¼')"
```

### 3.3 è¿è¡Œç»ƒä¹ 

#### 3.3.1 äº¤äº’å¼æ¨¡å¼ï¼ˆæ¨èï¼‰

```bash
python main.py --interactive
```

#### 3.3.2 å‘½ä»¤è¡Œæ¨¡å¼

```bash
# æŸ¥çœ‹å¸®åŠ©
python main.py --help

# è¿è¡ŒåŸºç¡€ç»ƒä¹ 
python main.py --exercise basic --records 10000

# è¿è¡Œå‹ç¼©ç®—æ³•ç»ƒä¹ 
python main.py --exercise compression --records 50000

# è¿è¡ŒæŸ¥è¯¢ä¼˜åŒ–ç»ƒä¹ 
python main.py --exercise query --records 100000

# è¿è¡Œåˆ†åŒºå­˜å‚¨ç»ƒä¹ 
python main.py --exercise partition --records 100000

# è¿è¡Œé«˜çº§ç‰¹æ€§ç»ƒä¹ 
python main.py --exercise advanced --records 1000

# è¿è¡Œæ‰€æœ‰ç»ƒä¹ 
python main.py --exercise all --records 5000
```

---

## 4. ç»ƒä¹ å†…å®¹

### 4.1 åŸºç¡€ç»ƒä¹ 

- Parquet æ–‡ä»¶è¯»å†™æ“ä½œ
- ä¸ CSV æ ¼å¼æ€§èƒ½å¯¹æ¯”
- æ–‡ä»¶å¤§å°å’Œå‹ç¼©æ•ˆæœåˆ†æ
- æ•°æ®å®Œæ•´æ€§éªŒè¯

### 4.2 å‹ç¼©ç®—æ³•ç»ƒä¹ 

- å¤šç§å‹ç¼©ç®—æ³•å¯¹æ¯” (snappy, gzip, lz4, brotli, zstd)
- å‹ç¼©æ¯”å’Œæ€§èƒ½æƒè¡¡åˆ†æ
- å¯è§†åŒ–å‹ç¼©æ•ˆæœ

### 4.3 æŸ¥è¯¢ä¼˜åŒ–ç»ƒä¹ 

- æŠ•å½±ä¸‹æ¨ (Projection Pushdown)
- è°“è¯ä¸‹æ¨ (Predicate Pushdown)
- ç»„åˆä¼˜åŒ–ç­–ç•¥
- å¤æ‚æŸ¥è¯¢æ€§èƒ½æµ‹è¯•

### 4.4 åˆ†åŒºç»ƒä¹ 

- åˆ†åŒºè¡¨çš„åˆ›å»ºå’Œç®¡ç†
- åˆ†åŒºè£å‰ª (Partition Pruning) æµ‹è¯•
- å¤šç§æŸ¥è¯¢åœºæ™¯æ€§èƒ½å¯¹æ¯”

### 4.5 é«˜çº§ç‰¹æ€§ç»ƒä¹ 

- åµŒå¥—æ•°æ®ç»“æ„å¤„ç†
- å…ƒæ•°æ®æ“ä½œå’Œåˆ†æ
- Schema æ¼”è¿›æµ‹è¯•

---

## 5. é¡¹ç›®ç»“æ„

```bash
parquet-practice-project/
â”œâ”€â”€ src/parquet_practice/          # æ ¸å¿ƒä»£ç æ¨¡å—
â”‚   â”œâ”€â”€ basic_exercise.py         # åŸºç¡€ç»ƒä¹ 
â”‚   â”œâ”€â”€ compression_exercise.py   # å‹ç¼©ç®—æ³•ç»ƒä¹ 
â”‚   â”œâ”€â”€ query_optimization_exercise.py  # æŸ¥è¯¢ä¼˜åŒ–ç»ƒä¹ 
â”‚   â”œâ”€â”€ partitioning_exercise.py  # åˆ†åŒºç»ƒä¹ 
â”‚   â””â”€â”€ advanced_exercise.py      # é«˜çº§ç‰¹æ€§ç»ƒä¹ 
â”œâ”€â”€ examples/                     # ç¤ºä¾‹è„šæœ¬
â”œâ”€â”€ tests/                       # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ output/                      # è¾“å‡ºç›®å½•
â”œâ”€â”€ main.py                      # ä¸»ç¨‹åºå…¥å£
â””â”€â”€ requirements.txt             # ä¾èµ–æ–‡ä»¶
```

---

## 6. è¾“å‡ºæ–‡ä»¶

ç»ƒä¹ ç»“æœä¿å­˜åœ¨ `output/` ç›®å½•ï¼š

- `basic_exercise_results.json` - åŸºç¡€ç»ƒä¹ ç»“æœ
- `compression_results.json` - å‹ç¼©ç®—æ³•æ¯”è¾ƒç»“æœ
- `query_optimization_results.json` - æŸ¥è¯¢ä¼˜åŒ–ç»“æœ
- `partitioning_results.json` - åˆ†åŒºå­˜å‚¨ç»“æœ
- `advanced_results.json` - é«˜çº§ç‰¹æ€§ç»“æœ

---

## 7. æ€§èƒ½åŸºå‡†

åŸºäº 10,000 æ¡è®°å½•çš„æµ‹è¯•ç»“æœï¼š

| æŒ‡æ ‡ | Parquet | CSV | æå‡ |
|------|---------|-----|------|
| è¯»å–æ—¶é—´ | 0.05s | 0.15s | 3.0x |
| å†™å…¥æ—¶é—´ | 0.08s | 0.12s | 1.5x |
| æ–‡ä»¶å¤§å° | 2.1MB | 5.8MB | 64% å‹ç¼© |
| å†…å­˜ä½¿ç”¨ | 45MB | 78MB | 42% èŠ‚çœ |

---

## 8. æ•…éšœæ’é™¤

### 8.1 ä¾èµ–å®‰è£…é—®é¢˜

å¦‚æœé‡åˆ° "externally-managed-environment" é”™è¯¯ï¼Œè¯·ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼š

```bash
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### 8.2 æƒé™é—®é¢˜

ç¡®ä¿å¯¹é¡¹ç›®ç›®å½•æœ‰è¯»å†™æƒé™ï¼Œç‰¹åˆ«æ˜¯ `output/` ç›®å½•ã€‚

---

## 9. å¼€å‘æŒ‡å—

### 9.1 ä»£ç è´¨é‡æ£€æŸ¥

```bash
make lint      # ä»£ç æ£€æŸ¥
make test      # è¿è¡Œæµ‹è¯•
make format    # ä»£ç æ ¼å¼åŒ–
```

### 9.2 æ·»åŠ æ–°ç»ƒä¹ 

1. åœ¨ `src/parquet_practice/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„ç»ƒä¹ æ¨¡å—
2. ç»§æ‰¿åŸºç¡€ç±»å¹¶å®ç°å¿…è¦çš„æ–¹æ³•
3. åœ¨ `main.py` ä¸­æ·»åŠ æ–°çš„ç»ƒä¹ é€‰é¡¹
4. ç¼–å†™ç›¸åº”çš„æµ‹è¯•ç”¨ä¾‹

---

**å¼€å§‹ä½ çš„ Parquet å­¦ä¹ ä¹‹æ—…ï¼** ğŸš€
